<script>
export default {
  name: 'left-navigation',
  components: {
    DhoBtn: () => import('./dho-btn.vue')
  },

  props: {
    dho: {
      type: Object,
      default: () => {
        return {
          name: 'hypha',
          title: 'Hypha DAO',
          icon: ''
        }
      }
    },
    dhos: {
      type: Array,
      default: () => []
    },
    width: {
      type: Number,
      default: 80
    }
  },

  data () {
    return {
      expanded: false
    }
  },

  computed: {
    activeTab () {
      if (this.$route.name === 'dashboard') return 'dashboard'
      if (this.$route.path.includes('proposals')) return 'proposals'
      if (this.$route.path.includes('members')) return 'members'
      if (this.$route.path.includes('organization')) return 'organization'
      if (this.$route.path.includes('explore')) return 'explore'
      return null
    },
    disabledSelector () {
      if (!this.dhos) {
        return true
      }
      return false
    }
  },

  methods: {
    icon (dho) {
      if (dho.isHypha) return 'hypha-logo.svg'
      return dho.icon
    },

    switchDao (url) {
      this.expanded = false
      this.$router.push({ name: this.activeTab || 'dashboard', params: { dhoname: url } })
    },

    expandSwitcher () {
      this.expanded = this.dhos.length > 1 ? !this.expanded : this.expanded
    }
  }
}
</script>

<template lang="pug">
.left-navigation.full-width.full-height
  .col.full-height
    .col.bg-external-bg(:class="{'col': expanded, 'overTop': expanded }")
      .column
        .col-auto.justify-center.q-pt-xl.dho-button--main
          dho-btn(:name="dho.name" :title="dho.title" :logo="dho.icon" :disable="disabledSelector" @click="expandSwitcher")
        .col-auto.q-mt-xs
          .column.dao-container(v-if="expanded")
            .row.full-width(v-for="dao in dhos")
              .full-width(:key="dao.name")
                dho-btn(v-if="dho.name != dao.name" v-bind="dao" :logo="dao.icon" @click="switchDao(dao.url)")
        .full-width.border-bot
    #nav-buttons.col-4.fixed-center
      .row.justify-center(v-if="!expanded")
        q-btn.q-ma-md(:class="{'active': activeTab=== 'dashboard'}" :flat="activeTab !== 'dashboard'" unelevated rounded padding="12px" icon="fas fa-home" size="sm" :color="activeTab === 'dashboard' ? 'primary' : 'disabled'" :to="{ name: 'dashboard' }")
        q-btn.q-ma-md(:class="{'active': activeTab=== 'proposals'}" :flat="activeTab !== 'proposals'" unelevated rounded padding="12px" icon="far fa-file-alt" size="sm" :color="activeTab === 'proposals' ? 'primary' : 'disabled'" :to="{ name: 'proposals' }")
          q-tooltip(anchor="center right" self="center left" :content-style="{ 'font-size': '1em' }") {{ $t('navigation.left-navigation.proposals') }}
        q-btn.q-ma-md(:class="{'active': activeTab=== 'members'}" :flat="activeTab !== 'members'" unelevated rounded padding="12px" icon="fas fa-users" size="sm" :color="activeTab === 'members' ? 'primary' : 'disabled'" :to="{ name: 'members' }")
          q-tooltip(anchor="center right" self="center left" :content-style="{ 'font-size': '1em' }") {{ $t('navigation.left-navigation.members') }}
        q-btn.q-ma-md(:class="{'active': activeTab=== 'organization'}" :flat="activeTab !== 'organization'" unelevated rounded padding="12px" icon="fas fa-building" size="sm" :color="activeTab === 'organization' ? 'primary' : 'disabled'" :to="{ name: 'organization' }")
          q-tooltip(anchor="center right" self="center left" :content-style="{ 'font-size': '1em' }") {{ $t('navigation.left-navigation.organization') }}
    .col.fixed-bottom.flex.items-end
      .row.justify-center.items-end.q-pb-lg
        q-btn.q-ma-md(:class="{'active': activeTab=== 'explore'}" :flat="activeTab !== 'explore'" unelevated rounded padding="12px" icon="fas fa-globe" size="sm" :color="activeTab === 'explore' ? 'primary' : 'disabled'" :to="{ name: 'explore' }")
          q-tooltip(anchor="center right" self="center left" :content-style="{ 'font-size': '1em' }") {{ $t('navigation.left-navigation.explore') }}

</template>

<style lang="stylus" scoped>
.q-btn.active:hover
  color: white !important;

#nav-buttons
  height auto
.overTop
  z-index: 2
  overflow: 'auto'
  max-height: 90vh
.dao-container
  overflow: 'auto'
  background: #FFFFFF
.border-bot
  border-bottom 1px solid $internal-bg
@media (max-height: 664px)
  #nav-buttons
    overflow-y: scroll
    height: -webkit-fill-available
  #nav-buttons::-webkit-scrollbar
    display: none
  .dho-button--main
    padding-top: 0
</style>
